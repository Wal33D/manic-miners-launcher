import{j as e,S as Y,E as _,F as ee,G as se,H as re,h as J,T as ae,B as A,P as ne,i as te,p as ie,g as le,r as a,C as p,l as f,o as j,Z as b,m as y,n as S,q as ce}from"./index-BW79gMh9.js";import{S as oe}from"./star-BDzFN9v7.js";import{E as de}from"./external-link-BIpPhR4K.js";function me({versions:n,selectedVersion:o,onVersionChange:m}){const I=i=>i?e.jsx(ae,{className:"w-4 h-4"}):e.jsx(oe,{className:"w-4 h-4"}),u=i=>i?"secondary":"default";return e.jsxs(Y,{value:o,onValueChange:m,children:[e.jsx(_,{className:"bg-input border-border",children:e.jsx(ee,{placeholder:"Select version..."})}),e.jsx(se,{className:"bg-popover border-border",children:n.map(i=>e.jsx(re,{value:i.version,children:e.jsxs("div",{className:"flex items-center gap-2",children:[I(i.experimental),i.displayName,e.jsx(J,{variant:u(i.experimental),className:"ml-2",children:i.experimental?"experimental":"stable"})]})},i.version))})]})}function Z({version:n}){const o=m=>m?"secondary":"default";return e.jsxs("div",{className:"p-4 rounded-lg bg-secondary/50 border border-border hover:bg-secondary/50",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:n.thumbnailUrl,alt:`${n.title} thumbnail`,className:"w-16 h-16 rounded object-cover border border-border",onError:m=>{m.currentTarget.style.display="none"}})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-secondary-foreground",children:n.title}),e.jsx(J,{variant:o(n.experimental),children:n.experimental?"experimental":"stable"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-muted-foreground",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Release Date:"})," ",new Date(n.releaseDate).toLocaleDateString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"File Size:"})," ",n.size]})]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:n.description||"No description available."})})]})}function $({version:n,isInstalled:o,onInstallOrLaunch:m,onDelete:I,onRepair:u,onCreateShortcuts:i}){return n?e.jsxs("div",{className:"space-y-3",children:[e.jsx(A,{variant:"energy",className:"w-full",size:"lg",onClick:m,children:o?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"w-5 h-5 mr-2"}),"Launch Game"]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Install Game"]})}),o&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(A,{variant:"outline",size:"sm",onClick:u,children:[e.jsx(ie,{className:"w-4 h-4 mr-1"}),"Verify"]}),i&&e.jsxs(A,{variant:"outline",size:"sm",onClick:i,title:"Create desktop and application shortcuts",children:[e.jsx(de,{className:"w-4 h-4 mr-1"}),"Shortcuts"]}),e.jsxs(A,{variant:"outline",size:"sm",onClick:I,className:"text-destructive hover:text-destructive col-span-2",children:[e.jsx(le,{className:"w-4 h-4 mr-1"}),"Uninstall"]})]})]}):null}function he({onDownloadStart:n,onDownloadEnd:o,onNotificationUpdate:m,removeNotification:I}){const[u,i]=a.useState([]),[T,P]=a.useState(""),[K,k]=a.useState(!0),[Q,V]=a.useState(new Set),[z,W]=a.useState(""),[xe,O]=a.useState(!1),[ue,X]=a.useState(0),[pe,fe]=a.useState(""),[je,ge]=a.useState(""),[ve,we]=a.useState(0),[Ne,be]=a.useState("0 MB/s"),[ye,Se]=a.useState("--:--"),[Ie,R]=a.useState(!1),[Pe,E]=a.useState(0),[Ve,F]=a.useState(""),[Ae,L]=a.useState(!1),[Ce,B]=a.useState(0),[De,G]=a.useState("");a.useEffect(()=>{const l=async()=>{try{const t=await(await fetch("https://manic-launcher.vercel.app/api/versions/archived")).json();if(t!=null&&t.versions){const h=t.versions.sort((x,D)=>{const g=c=>c.split(".").map(d=>parseInt(d,10)),v=g(x.version),w=g(D.version);for(let c=0;c<Math.max(v.length,w.length);c++){const d=v[c]||0,N=w[c]||0;if(d!==N)return N-d}return 0});i(h),h.length>0&&P(h[0].version),V(new Set)}}catch(r){ce.error("VERSION","Failed to fetch versions",{error:r.message})}finally{k(!1)}};window.electronAPI?(window.electronAPI.send("get-directories"),window.electronAPI.receiveOnce("get-directories",r=>{r!=null&&r.status&&W(r.directories.launcherInstallPath)}),window.electronAPI.send("request-archived-versions-information"),window.electronAPI.receiveOnce("request-archived-versions-information",r=>{if(r!=null&&r.versions){const t=r.versions.sort((x,D)=>{const g=c=>c.split(".").map(d=>parseInt(d,10)),v=g(x.version),w=g(D.version);for(let c=0;c<Math.max(v.length,w.length);c++){const d=v[c]||0,N=w[c]||0;if(d!==N)return N-d}return 0});i(t),r.defaultVersion?P(r.defaultVersion.version):t.length>0&&P(t[0].version);const h=new Set(t.filter(x=>x.directory).map(x=>x.version));V(h)}k(!1)})):l()},[]);const s=u.find(l=>l.version===T),C=l=>Q.has(l),M=()=>{if(!(!s||!window.electronAPI))if(C(s.version))window.electronAPI.send("launch-game",s.identifier);else{if(!z)return;n==null||n(),O(!0),X(0),window.electronAPI.send("download-version",{version:s.identifier,downloadPath:z}),window.electronAPI.receiveOnce("download-version",l=>{O(!1),o==null||o(),l!=null&&l.downloaded&&V(r=>new Set([...r,s.version]))})}},q=()=>{if(!s||!window.electronAPI)return;L(!0),B(0),G("Removing game files...");const l=setInterval(()=>{B(r=>{const t=r+Math.random()*20;return t>=100?(clearInterval(l),G("Deletion completed successfully!"),setTimeout(()=>L(!1),2e3),100):t})},300);window.electronAPI.send("delete-version",s.identifier),window.electronAPI.receiveOnce("delete-version",r=>{r!=null&&r.deleted&&V(t=>{const h=new Set(t);return h.delete(s.version),h})})},U=async()=>{if(!s||!window.electronAPI)return;R(!0),E(0),F("Checking files..."),window.electronAPI.send("repair-version",s.identifier);const l=setInterval(()=>{E(r=>{const t=r+Math.random()*10;return t>=100?(clearInterval(l),F("Repair completed successfully!"),setTimeout(()=>R(!1),2e3),100):t})},400)},H=async()=>{!s||!window.electronAPI||window.electronAPI.send("create-shortcuts",{version:s.identifier,options:{createExeShortcut:!0,createDirShortcut:!1}})};return K?e.jsxs("div",{className:"container mx-auto p-6 flex-1 min-h-0",children:[e.jsx("div",{className:"space-y-8",children:e.jsxs(p,{className:"mining-surface energy-glow border-primary/20",children:[e.jsx(f,{className:"pb-6",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-6 bg-muted rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-muted rounded w-2/3"})]})}),e.jsx(j,{children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-12 bg-muted rounded"}),e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"})]})})]})}),e.jsx("div",{className:"h-20"})]}):e.jsxs("div",{className:"container mx-auto p-6 flex-1 min-h-0",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs(p,{className:"mining-surface border-primary/20 shadow-lg overflow-hidden",children:[e.jsx(f,{className:"border-b border-border/50 pb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(y,{className:"text-lg text-primary",children:"Select Version"}),e.jsx(S,{children:"Choose from stable releases and experimental builds"})]})]})}),e.jsx(j,{className:"p-6",children:e.jsx(me,{versions:u,selectedVersion:T,onVersionChange:P})})]}),e.jsx("div",{className:"xl:hidden",children:e.jsxs(p,{className:"mining-surface border-primary/20 shadow-lg overflow-hidden",children:[e.jsx(f,{className:"border-b border-border/50 pb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(y,{className:"text-lg text-primary",children:"Actions"}),e.jsx(S,{children:"Install, launch, or manage"})]})]})}),e.jsx(j,{className:"p-6",children:e.jsx($,{version:s,isInstalled:s?C(s.version):!1,onInstallOrLaunch:M,onDelete:q,onRepair:U,onCreateShortcuts:H})})]})}),e.jsxs("div",{className:"hidden xl:grid xl:grid-cols-3 gap-6",children:[s&&e.jsxs(p,{className:"mining-surface border-primary/20 shadow-lg xl:col-span-2 overflow-hidden",children:[e.jsx(f,{className:"border-b border-border/50 pb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(y,{className:"text-lg text-primary",children:"Version Details"}),e.jsxs(S,{children:["Information about ",s.displayName]})]})]})}),e.jsx(j,{className:"p-6",children:e.jsx(Z,{version:s})})]}),e.jsxs(p,{className:"mining-surface border-primary/20 shadow-lg overflow-hidden self-start",children:[e.jsx(f,{className:"border-b border-border/50 pb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(y,{className:"text-lg text-primary",children:"Actions"}),e.jsx(S,{children:"Install, launch, or manage"})]})]})}),e.jsx(j,{className:"p-6",children:e.jsx($,{version:s,isInstalled:s?C(s.version):!1,onInstallOrLaunch:M,onDelete:q,onRepair:U,onCreateShortcuts:H})})]})]}),e.jsx("div",{className:"xl:hidden",children:s&&e.jsxs(p,{className:"mining-surface border-primary/20 shadow-lg overflow-hidden",children:[e.jsx(f,{className:"border-b border-border/50 pb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(y,{className:"text-lg text-primary",children:"Version Details"}),e.jsxs(S,{children:["Information about ",s.displayName]})]})]})}),e.jsx(j,{className:"p-6",children:e.jsx(Z,{version:s})})]})})]}),e.jsx("div",{className:"h-20"})]})}const Oe=({onNotificationUpdate:n,removeNotification:o})=>e.jsx("div",{className:"h-full flex flex-col overflow-y-auto relative",children:e.jsx(he,{onNotificationUpdate:n,removeNotification:o})});export{Oe as default};
